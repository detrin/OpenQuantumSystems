<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dimer · OpenQuantumSystems.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'G-F12F2Y92VY', 'auto');
ga('send', 'pageview');
</script><link rel="canonical" href="https://detrin.github.io/OpenQuantumSystems.jl/latest/tutorials/dimer/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>OpenQuantumSystems.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><a class="toctext" href="../../documentation/">Documentation</a></li><li><span class="toctext">Tutorials</span><ul><li class="current"><a class="toctext" href>Dimer</a><ul class="internal"><li><a class="toctext" href="#Simple-example-1">Simple example</a></li><li><a class="toctext" href="#Local-vs-exciton-basis-1">Local vs exciton basis</a></li><li><a class="toctext" href="#Animating-density-matrix-1">Animating density matrix</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Tutorials</li><li><a href>Dimer</a></li></ul><a class="edit-page" href="https://github.com/detrin/OpenQuantumSystems.jl/blob/master/docs/src/tutorials/dimer.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Dimer</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Dimer-examples-1" href="#Dimer-examples-1">Dimer examples</a></h1><h2><a class="nav-anchor" id="Simple-example-1" href="#Simple-example-1">Simple example</a></h2><p>Running the basics dimer with ultra-fast laser excitation.</p><pre><code class="language-julia">using Plots
using LaTeXStrings
using OpenQuantumSystems

HR = 0.01
shift = (2.0 * HR)^0.5
mode = Mode(300., shift)
mols = [
    Molecule([mode], 5, [12500., 12750.]),
    Molecule([mode], 5, [12500., 12800.])
]

agg = Aggregate(mols)
# 1 is for el. ground state
agg.coupling[2, 3] = 100
agg.coupling[3, 2] = 100

aggInds, vibindices, aggIndLen, basis, FCFact, FCProd, Ham, Ham_0, Ham_I = 
    setupAggregate(agg; verbose=false)

T = 100 # temperature
W0 = thermal_state_composite(T, [0.0, 0.5, 0.5], Ham, aggInds) # laser excitation
t_max = 0.2
t_count = 250
tspan=[0.0:t_max/t_count:t_max;]
tspan, W_t = evolution_approximate(W0, tspan, Ham)
rho_tr_t = zeros(ComplexF64, length(tspan), 2, 2)
for t_i in 1:length(tspan)
    rho_tr_t[t_i, :, :] = trace_bath(W_t[t_i].data, agg, FCProd, aggInds, vibindices)
end

plot(tspan, real(rho_tr_t[:, 1, 1]), label=L&quot;\rho_{11}&quot;)
plot!(tspan, real(rho_tr_t[:, 2, 2]), label=L&quot;\rho_{22}&quot;, 
    ylim=(0.0,1.0), ylabel=L&quot;\rho_{nn}&quot;, xlabel=L&quot;t\:\:\mathrm{(a.u.)}&quot;)</code></pre><p><img src="../../assets/dimer_simple.png" alt="dimer simple"/></p><h2><a class="nav-anchor" id="Local-vs-exciton-basis-1" href="#Local-vs-exciton-basis-1">Local vs exciton basis</a></h2><p>Running the basics dimer with ultra-fast laser excitation.</p><pre><code class="language-julia">using ProgressMeter
using Plots
using LaTeXStrings
using OpenQuantumSystems

HR = 0.01
shift = (2.0 * HR)^0.5
mode = Mode(300., shift)
mols = [
    Molecule([mode], 5, [12500., 12750.]),
    Molecule([mode], 5, [12500., 12800.])
]

agg = Aggregate(mols)
# 1 is for el. ground state
agg.coupling[2, 3] = 100
agg.coupling[3, 2] = 100

aggInds, vibindices, aggIndLen, basis, FCFact, FCProd, Ham, Ham_0, Ham_I = 
    setupAggregate(agg; verbose=false)

Ham_sys = getAggHamiltonianSystem(agg; groundState = false)
Ham_sys_lambda, Ham_sys_S = eigen(Ham_sys.data)
Ham_sys_Sinv = inv(Ham_sys_S)
Ham_sys_lambda = diagm(Ham_sys_lambda)

T = 100 # temperature
W0 = thermal_state_composite(T, [0.0, 0.5, 0.5], Ham, aggInds) # laser excitation

t_max = 0.2
t_count = 500
tspan=[0.0:t_max/t_count:t_max;]</code></pre><p>Calculating dynamics in local basis.</p><pre><code class="language-julia">rho_tr_t = zeros(ComplexF64, length(tspan), 2, 2)
t_i = 0
t_step = tspan[2] - tspan[1]
U_op_step = evolutionOperator(Ham, t_step)
U_op_step_d = U_op_step&#39;
W = deepcopy(W0)
p = Progress(t_count, barglyphs=BarGlyphs(&quot;[=&gt; ]&quot;), barlen=50)
for t_i in 1:length(tspan)
    rho_traced = trace_bath(W.data, agg, FCProd, aggInds, vibindices; groundState=false)
    rho_tr_t[t_i, :, :] = rho_traced
    W = U_op_step * W * U_op_step_d
    ProgressMeter.next!(p)
end

plot(tspan, real(rho_tr_t[:, 1, 1]), label=L&quot;\rho_{11}&quot;)
plot!(tspan, real(rho_tr_t[:, 2, 2]), label=L&quot;\rho_{22}&quot;, 
    ylim=(0.0,1.0), ylabel=L&quot;\rho_{nn}&quot;, xlabel=L&quot;t\:\:\mathrm{(a.u.)}&quot;)</code></pre><p><img src="../../assets/dimer_local.png" alt="dimer simple"/></p><p>Calculating dynamics in exciton basis.</p><pre><code class="language-julia">rho_tr_t = zeros(ComplexF64, length(tspan), 2, 2)
t_i = 0
t_step = tspan[2] - tspan[1]
U_op_step = evolutionOperator(Ham, t_step)
U_op_step_d = U_op_step&#39;
W = deepcopy(W0)
p = Progress(t_count, barglyphs=BarGlyphs(&quot;[=&gt; ]&quot;), barlen=50)
for t_i in 1:length(tspan)
    rho_traced = trace_bath(W.data, agg, FCProd, aggInds, vibindices; groundState=false)
    rho_traced = Ham_sys_Sinv * rho_traced * Ham_sys_S
    rho_tr_t[t_i, :, :] = rho_traced
    W = U_op_step * W * U_op_step_d
    ProgressMeter.next!(p)
end

plot(tspan, real(rho_tr_t[:, 1, 1]), label=L&quot;\rho_{11}&quot;)
plot!(tspan, real(rho_tr_t[:, 2, 2]), label=L&quot;\rho_{22}&quot;, 
    ylim=(0.0,1.0), ylabel=L&quot;\rho_{nn}&quot;, xlabel=L&quot;t\:\:\mathrm{(a.u.)}&quot;)</code></pre><p><img src="../../assets/dimer_exc.png" alt="dimer simple"/></p><h2><a class="nav-anchor" id="Animating-density-matrix-1" href="#Animating-density-matrix-1">Animating density matrix</a></h2><p>Plotting the diagonal of bath part of density matrix.</p><pre><code class="language-julia">W_bath_t = zeros(ComplexF64, length(tspan), aggIndLen, aggIndLen)
t_i = 0
t_step = tspan[2] - tspan[1]
U_op_step = evolutionOperator(Ham, t_step)
U_op_step_d = U_op_step&#39;
W = deepcopy(W0)
p = Progress(t_count, barglyphs=BarGlyphs(&quot;[=&gt; ]&quot;), barlen=50)
for t_i in 1:length(tspan)
    W_bath = get_rho_bath(W.data, agg, FCProd, aggInds, vibindices; 
        groundState = false, justCopy=false)
    W_bath_t[t_i, :, :] = W_bath
    W = U_op_step * W * U_op_step_d
    ProgressMeter.next!(p)
end

plot(tspan, real(W_bath_t[:, 1, 1]), label=L&quot;\rho_{\mathrm{B,}11}&quot;)
println(aggIndLen)
for i in 2:(length(vibindices[2]) - 1)
    plot!(tspan, real(W_bath_t[:, i, i]), label=L&quot;\rho_{\mathrm{B,}%$i%$i}&quot;)
end
i = length(vibindices[2])
plot!(tspan, real(W_bath_t[:, i, i]), 
    label=L&quot;\rho_{\mathrm{B,}%$i%$i}&quot;, ylim=(0.0,1.0), ylabel=L&quot;\rho_{nn}&quot;, 
    xlabel=L&quot;t\:\:\mathrm{(a.u.)}&quot;)</code></pre><p><img src="../../assets/dimer_bath_lineplot.png" alt="dimer simple"/></p><pre><code class="language-julia">p = Progress(t_count, barglyphs=BarGlyphs(&quot;[=&gt; ]&quot;), barlen=50)
anim = @animate for i = 1:length(tspan)
    h_re = heatmap(real(rho_bath_t[i, :, :]), 
        aspect_ratio=:equal, title=&quot;Re &quot; * lpad(i, 4, &quot;0&quot;), c=:magma, clim=(-1.0,1.0))
    h_im = heatmap(imag(rho_bath_t[i, :, :]), 
        aspect_ratio=:equal, title=&quot;Im&quot; * lpad(i, 4, &quot;0&quot;), c=:magma, clim=(-1.0,1.0))
    ProgressMeter.next!(p)
    plot(h_re, h_im, layout = (1, 2), legend = false, axis = nothing)
end
 
gif(anim, fps = 30)</code></pre><p><img src="../../assets/dimer_bath_part.gif" alt="dimer simple"/></p><p>Plotting the diagonal of density matrix.</p><pre><code class="language-julia">W_t = zeros(ComplexF64, length(tspan), aggIndLen, aggIndLen)
t_i = 0
t_step = tspan[2] - tspan[1]
U_op_step = evolutionOperator(Ham, t_step)
U_op_step_d = U_op_step&#39;
W = deepcopy(W0)
p = Progress(t_count, barglyphs=BarGlyphs(&quot;[=&gt; ]&quot;), barlen=50)
for t_i in 1:length(tspan)
    W_t[t_i, :, :] = W.data
    W = U_op_step * W * U_op_step_d
    ProgressMeter.next!(p)
end

plot(tspan, real(W_t[:, 1, 1]), label=L&quot;\rho_{\mathrm{B,}11}&quot;)
println(aggIndLen)
for i in 2:(length(vibindices[2]) - 1)
    plot!(tspan, real(W_t[:, i, i]), label=L&quot;\rho_{\mathrm{B,}%$i%$i}&quot;)
end
i = length(vibindices[2])
plot!(tspan, real(W_t[:, i, i]), 
    label=L&quot;\rho_{\mathrm{B,}%$i%$i}&quot;, ylim=(0.0,1.0), ylabel=L&quot;\rho_{nn}&quot;, 
    xlabel=L&quot;t\:\:\mathrm{(a.u.)}&quot;)</code></pre><p><img src="../../assets/dimer_lineplot.png" alt="dimer simple"/></p><pre><code class="language-julia">p = Progress(t_count, barglyphs=BarGlyphs(&quot;[=&gt; ]&quot;), barlen=50)
anim = @animate for i = 1:length(tspan)
    h_re = heatmap(real(W_t[i, :, :]), 
        aspect_ratio=:equal, title=&quot;Re &quot; * lpad(i, 4, &quot;0&quot;), c=:magma, clim=(-1.0,1.0))
    h_im = heatmap(imag(W_t[i, :, :]), 
        aspect_ratio=:equal, title=&quot;Im&quot; * lpad(i, 4, &quot;0&quot;), c=:magma, clim=(-1.0,1.0))
    ProgressMeter.next!(p)
    plot(h_re, h_im, layout = (1, 2), legend = false, axis = nothing)
end
 
gif(anim, fps = 30)</code></pre><p><img src="../../assets/dimer.gif" alt="dimer simple"/></p><footer><hr/><a class="previous" href="../../documentation/"><span class="direction">Previous</span><span class="title">Documentation</span></a></footer></article></body></html>
